# PR Reviewer Assignment Service

## Архитектурные решения и допущения

### Публичный API

Сервис задуман как полностью открытый внутри контура: все эндпоинты доступны без авторизации и дополнительного заголовка `Authorization`. Это упрощает интеграции и соответствует текущей OpenAPI спецификации. При необходимости ограничить доступ позже достаточно будет вернуть middleware и описать security-схемы.

### Доменная модель vs API контракт

**Поле `need_more_reviewers`**
- Упоминается в описании задания, но **отсутствует в OpenAPI спецификации**
- **Подход к реализации**:
  - Поле существует в доменной модели и автоматически пересчитывается
  - Не возвращается в API ответах для соответствия OpenAPI
  - Может быть легко добавлено в DTO/мапперы при обновлении спецификации

**Бизнес-логика**
- Автоназначение: До 2 активных ревьюверов из команды автора (исключая автора)
- Переназначение: Замена из **команды заменяемого ревьювера** (не автора)
- После merge: Изменение ревьюверов запрещено при статусе `MERGED`
- Идемпотентность: Повторные вызовы возвращают текущее состояние без ошибок

### Тестовая БД для интеграционных тестов

- В `docker-compose.yml` есть второй PostgreSQL сервис `postgres_test` (порт `5434`) специально для интеграционных тестов. 
- При поднятии стенда `docker-compose up` создаёт две базы: рабочую (`pr_reviewer_db`) и тестовую (`pr_reviewer_test_db`). 
- Это позволяет изолировать тестовые сценарии от основной БД.
