# PR Reviewer Assignment Service

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ä–µ–≤—å—é–µ—Ä–æ–≤ –Ω–∞ Pull Request'—ã —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–æ–º–∞–Ω–¥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* Docker & Docker Compose
* Go 1.25+ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
* Make

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**

   ```bash
   git clone https://github.com/Magomed-cmd/pr-reviewer-assignment
   cd pr-reviewer-assignment
   ```

2. **–ü–æ–¥–Ω—è—Ç—å —Å–µ—Ä–≤–∏—Å —á–µ—Ä–µ–∑ Docker Compose**

   ```bash
   docker compose up -d
   ```

   –≠—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
   * –ø–æ–¥–Ω–∏–º–µ—Ç PostgreSQL (–æ—Å–Ω–æ–≤–Ω–∞—è –ë–î + —Ç–µ—Å—Ç–æ–≤–∞—è);
   * –ø—Ä–∏–º–µ–Ω–∏—Ç –º–∏–≥—Ä–∞—Ü–∏–∏;
   * –∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–∏—Å –Ω–∞ –ø–æ—Ä—Ç—É `8080`.

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å**

   ```bash
   curl http://localhost:8080/health
   ```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Makefile

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
make test             # –í—Å–µ —Ç–µ—Å—Ç—ã
make test-integration # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
make test-e2e         # E2E-—Ç–µ—Å—Ç—ã

# –†–∞–±–æ—Ç–∞ —Å –ë–î
make migrate-up       # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
make migrate-down     # –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏

# –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
make lint             # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–µ—Ä–æ–º

# –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
make load-test        # k6-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
docker compose down -v # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å volumes
```

## API

–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API —Å–æ–≥–ª–∞—Å–Ω–æ OpenAPI-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (`plan/openapi.yaml`):

* `POST /team/add` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã;
* `GET /team/get` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã;
* `POST /users/setIsActive` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
* `GET /users/getReview` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ PR'–æ–≤, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∑–Ω–∞—á–µ–Ω —Ä–µ–≤—å—é–≤–µ—Ä–æ–º;
* `POST /pullRequest/create` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ PR —Å –∞–≤—Ç–æ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º —Ä–µ–≤—å—é–≤–µ—Ä–æ–≤;
* `POST /pullRequest/merge` ‚Äî –ø–µ—Ä–µ–≤–æ–¥ PR –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `MERGED` (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ);
* `POST /pullRequest/reassign` ‚Äî –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–µ–≤—å—é–≤–µ—Ä–∞.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –≥–µ–∫—Å–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:

* `internal/core/domain` ‚Äî –¥–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∏ —Ç–∏–ø—ã;
* `internal/core/services` ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞;
* `internal/core/ports` ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤/—Å–µ—Ä–≤–∏—Å–æ–≤/—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π;
* `internal/adapters/input/http` ‚Äî HTTP-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (Gin);
* `internal/adapters/output/database` ‚Äî PostgreSQL-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (pgx);
* `internal/infrastructure` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ä–æ—É—Ç–µ—Ä, –±–∞–∑–∞, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

## –î–æ–º–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

* –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PR –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∞—é—Ç—Å—è **–¥–æ –¥–≤—É—Ö** –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–µ–≤—å—é–≤–µ—Ä–æ–≤ –∏–∑ **–∫–æ–º–∞–Ω–¥—ã –∞–≤—Ç–æ—Ä–∞**, –∏—Å–∫–ª—é—á–∞—è —Å–∞–º–æ–≥–æ –∞–≤—Ç–æ—Ä–∞.
* –ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–µ–≤—å—é–≤–µ—Ä–æ–≤ –º–µ–Ω—å—à–µ –¥–≤—É—Ö, –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ (1 –∏–ª–∏ 2). –°–∏—Ç—É–∞—Ü–∏—è —Å 0 —Ä–µ–≤—å—é–≤–µ—Ä–∞–º–∏ —Ç—Ä–∞–∫—Ç—É–µ—Ç—Å—è –∫–∞–∫ –æ—à–∏–±–∫–∞ –¥–æ–º–µ–Ω–∞ (`NO_CANDIDATE`) –∏ PR –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è.
* –ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–µ–≤—å—é–≤–µ—Ä–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö **–∫–æ–º–∞–Ω–¥—ã –∑–∞–º–µ–Ω—è–µ–º–æ–≥–æ —Ä–µ–≤—å—é–≤–µ—Ä–∞**, —Å —É—á—ë—Ç–æ–º —Ñ–ª–∞–≥–æ–≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —É–∂–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö —Ä–µ–≤—å—é–≤–µ—Ä–æ–≤.
* –ü–æ—Å–ª–µ –ø–µ—Ä–µ–≤–æ–¥–∞ PR –≤ —Å—Ç–∞—Ç—É—Å `MERGED` –ª—é–±—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ä–µ–≤—å—é–≤–µ—Ä–æ–≤ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –¥–æ–º–µ–Ω–Ω–æ–π –æ—à–∏–±–∫–µ `PR_MERGED`.
* –û–ø–µ—Ä–∞—Ü–∏—è merge (`/pullRequest/merge`) —è–≤–ª—è–µ—Ç—Å—è –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ–π: –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—ã–∑–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ PR –±–µ–∑ –æ—à–∏–±–∫–∏.

## –¢–µ—Å—Ç—ã

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

* –†–∞–±–æ—Ç–∞—é—Ç –ø–æ–≤–µ—Ä—Ö —Ä–µ–∞–ª—å–Ω–æ–≥–æ PostgreSQL (—Å–µ—Ä–≤–∏—Å `postgres_test` –Ω–∞ –ø–æ—Ä—Ç—É `5434`).
* –ò—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã, HTTP-—Å–ª–æ–π –Ω–µ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è ‚Äî Gin –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏.

–ó–∞–ø—É—Å–∫:

```bash
docker compose up -d postgres_test
make test-integration
```

### E2E-—Ç–µ—Å—Ç—ã

* –ü–æ–¥–Ω–∏–º–∞—é—Ç HTTP-—Ä–æ—É—Ç–µ—Ä —á–µ—Ä–µ–∑ `httptest.Server`;
* –ò—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–µ–∞–ª—å–Ω—É—é –ë–î `postgres_test`;
* –ü—Ä–æ–≤–µ—Ä—è—é—Ç –ø–æ–ª–Ω—ã–µ —Å–∫–≤–æ–∑–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è/merge/–ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è PR.

–ó–∞–ø—É—Å–∫:

```bash
docker compose up -d postgres_test
make test-e2e
```

## –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ–ø–∏—Å–∞–Ω—ã –≤ `scripts/load_test/load_test.js` (k6).

–ü—Ä–∏–º–µ—Ä–Ω–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–¥–ª—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–∞):

* p95 –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ < 300 –º—Å;
* –¥–æ–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ > 99.9% –ø—Ä–∏ RPS, —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–æ–º —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∑–∞–¥–∞—á–∫–∏.

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ .env

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –∑–∞–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

–ü—Ä–∏–º–µ—Ä `.env` (—Ñ–∞–π–ª **–ø—Ä–µ–¥–Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –≤–∫–ª—é—á—ë–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä—è—é—â–µ–º—É –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –Ω–∏—á–µ–≥–æ –¥–æ–ø–∏—Å—ã–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é; –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –±–æ–µ–≤—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö —Ç–∞–∫–æ–π —Ñ–∞–π–ª, –∫–æ–Ω–µ—á–Ω–æ, –Ω–µ –¥–æ–ª–∂–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ Git):

```env
DB_HOST=postgres
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=password
DB_NAME=pr_reviewer_db
DB_SSLMODE=disable

PORT=8080
GIN_MODE=debug
```

–Ø –æ—Å–æ–∑–Ω–∞—é, —á—Ç–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Å –ø–∞—Ä–æ–ª—è–º–∏ –æ–±—ã—á–Ω–æ –Ω–µ –∫–æ–º–º–∏—Ç—è—Ç, –∏ –≤ –ø—Ä–æ–¥–µ –¥–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–µ–∫—Ä–µ—Ç—ã/—Ö—Ä–∞–Ω–∏–ª–∏—â–∞. –í —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è `.env` —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ –æ—Å—Ç–∞–≤–ª–µ–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Ä–∞–¥–∏ —É–¥–æ–±—Å—Ç–≤–∞ –∑–∞–ø—É—Å–∫–∞.

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –µ—Å–ª–∏ –±—É–¥—É—Ç –∫–∞–∫–∏–µ —Ç–æ –∑–∞–º–µ—á–∞–Ω–∏—è –∏–ª–∏ –¥—Ä—É–≥–∏–µ –º–æ–º–µ–Ω—Ç—ã, –≥–¥–µ –º–æ—ë —Ä–µ—à–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –≤–∞–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –∏ –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ –≤–∞—à–µ –∏—Ç–æ–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ, —Ç–æ –µ—Å–ª–∏ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å, –±—ã–ª–æ –±—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ, –µ—Å–ª–∏ –±—ã –≤—ã —Ä–∞—Å–ø–∏—Å–∞–ª–∏ –∏—Ö –¥–ª—è –º–æ–µ–≥–æ –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–º–µ @Wendigo957, –ª–∏–±–æ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –Ω–∞ –ø–æ—á—Ç—É –ø–∏—Å—å–º–æ. üòÅ