# PR Reviewer Assignment Service

## Архитектурные решения и допущения

### Безопасность API

**Создание команд**
- Эндпоинт `POST /team/add` не содержит блока `security` в предоставленной `openapi.yaml`
- Сервис реализует его как публичный согласно спецификации
- **Примечание**: Если потребуется ограничить создание команд только администраторами, необходимо добавить `security: [AdminToken: []]` в OpenAPI и обновить middleware

**Авторизационные токены**
- Для упрощённого стенда используются статические токены (`ADMIN_TOKEN`, `USER_TOKEN`), задаваемые через переменные окружения (по умолчанию `admin-secret` / `user-secret`).
- Эндпоинты проверяют токен из заголовка `Authorization`, можно передавать как `Bearer <token>`, так и просто `<token>`.
- В продакшене токены должны задаваться безопасно и вращаться по мере необходимости.
- Рассматривал вариант JWT‑авторизации, но для данного сервиса (и проверки ревьюером) статические токены проще: не нужно генерировать/подписывать токены вручную для проверки эндпоинтов. Для демонстрации JWT‑подхода могу сослаться на пет‑проекты.

### Доменная модель vs API контракт

**Поле `need_more_reviewers`**
- Упоминается в описании задания, но **отсутствует в OpenAPI спецификации**
- **Подход к реализации**:
  - Поле существует в доменной модели и автоматически пересчитывается
  - Не возвращается в API ответах для соответствия OpenAPI
  - Может быть легко добавлено в DTO/мапперы при обновлении спецификации

**Бизнес-логика**
- Автоназначение: До 2 активных ревьюверов из команды автора (исключая автора)
- Переназначение: Замена из **команды заменяемого ревьювера** (не автора)
- После merge: Изменение ревьюверов запрещено при статусе `MERGED`
- Идемпотентность: Повторные вызовы возвращают текущее состояние без ошибок
